<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #16a34a;
            --warning: #d97706;
            --danger: #dc2626;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-500: #6b7280;
            --gray-700: #374151;
            --gray-900: #111827;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            font-size: 11pt;
            line-height: 1.5;
            color: var(--gray-900);
            background: white;
        }

        .container {
            max-width: 100%;
            padding: 0;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 24pt;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header .subtitle {
            font-size: 12pt;
            opacity: 0.9;
        }

        .header .meta {
            margin-top: 15px;
            font-size: 10pt;
            opacity: 0.8;
        }

        /* Logo */
        .logo {
            font-size: 14pt;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-bottom: 20px;
        }

        .logo span {
            color: #60a5fa;
        }

        /* Sections */
        .section {
            margin-bottom: 30px;
            page-break-inside: avoid;
        }

        .section-header {
            background: var(--gray-100);
            padding: 12px 15px;
            border-left: 4px solid var(--primary);
            margin-bottom: 15px;
        }

        .section-header h2 {
            font-size: 14pt;
            font-weight: 600;
            color: var(--gray-900);
        }

        .section-content {
            padding: 0 15px;
        }

        /* Cards */
        .card {
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: white;
        }

        .card-header {
            font-weight: 600;
            color: var(--gray-700);
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gray-200);
        }

        /* Info grid */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 9pt;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .info-value {
            font-size: 12pt;
            font-weight: 500;
            color: var(--gray-900);
        }

        /* Zone badge */
        .zone-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14pt;
        }

        .zone-residential { background: #dbeafe; color: #1e40af; }
        .zone-commercial { background: #fef3c7; color: #92400e; }
        .zone-industrial { background: #e5e7eb; color: #374151; }
        .zone-rural { background: #d1fae5; color: #065f46; }
        .zone-environmental { background: #dcfce7; color: #166534; }
        .zone-mixed_use { background: #f3e8ff; color: #6b21a8; }

        /* Lists */
        .list {
            list-style: none;
            padding: 0;
        }

        .list li {
            padding: 8px 0;
            border-bottom: 1px solid var(--gray-100);
            display: flex;
            align-items: flex-start;
        }

        .list li:last-child {
            border-bottom: none;
        }

        .list-icon {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            flex-shrink: 0;
        }

        .check-icon { color: var(--success); }
        .x-icon { color: var(--danger); }
        .warning-icon { color: var(--warning); }

        /* Status badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 9pt;
            font-weight: 500;
            text-transform: uppercase;
        }

        .badge-success { background: #dcfce7; color: #166534; }
        .badge-warning { background: #fef3c7; color: #92400e; }
        .badge-danger { background: #fee2e2; color: #991b1b; }
        .badge-info { background: #dbeafe; color: #1e40af; }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        th, td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        th {
            background: var(--gray-50);
            font-weight: 600;
            font-size: 10pt;
            color: var(--gray-700);
        }

        /* Scenario cards */
        .scenario-card {
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .scenario-title {
            font-weight: 600;
            font-size: 12pt;
        }

        .feasibility-high { color: var(--success); }
        .feasibility-medium { color: var(--warning); }
        .feasibility-low { color: var(--danger); }

        /* Hazard alerts */
        .hazard-alert {
            display: flex;
            padding: 12px 15px;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .hazard-alert.low { background: #f0fdf4; border-left: 4px solid #16a34a; }
        .hazard-alert.medium { background: #fffbeb; border-left: 4px solid #d97706; }
        .hazard-alert.high { background: #fef2f2; border-left: 4px solid #dc2626; }
        .hazard-alert.extreme { background: #fef2f2; border-left: 4px solid #991b1b; }

        .hazard-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .hazard-content h4 {
            font-weight: 600;
            margin-bottom: 4px;
        }

        .hazard-content p {
            font-size: 10pt;
            color: var(--gray-600);
        }

        /* Footer */
        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-200);
            font-size: 9pt;
            color: var(--gray-500);
        }

        .footer .disclaimer {
            background: var(--gray-50);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }

        /* Page breaks */
        .page-break {
            page-break-after: always;
        }

        /* Print styles */
        @media print {
            .header {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">Site<span>ora</span></div>
            <h1>Property Planning Report</h1>
            <div class="subtitle">{{ address }}</div>
            <div class="meta">
                Generated on {{ generated_at }} | Report ID: {{ report_id if report_id else 'N/A' }}
            </div>
        </div>

        <!-- Property Overview -->
        <div class="section">
            <div class="section-header">
                <h2>Property Overview</h2>
            </div>
            <div class="section-content">
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Address</span>
                        <span class="info-value">{{ address }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">State</span>
                        <span class="info-value">{{ state }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Coordinates</span>
                        <span class="info-value">{{ "%.6f"|format(lat) }}, {{ "%.6f"|format(lon) }}</span>
                    </div>
                    {% if lga %}
                    <div class="info-item">
                        <span class="info-label">Local Government Area</span>
                        <span class="info-value">{{ lga }}</span>
                    </div>
                    {% endif %}
                    {% if lot_plan %}
                    <div class="info-item">
                        <span class="info-label">Lot/Plan</span>
                        <span class="info-value">{{ lot_plan }}</span>
                    </div>
                    {% endif %}
                    {% if lot_area %}
                    <div class="info-item">
                        <span class="info-label">Lot Area</span>
                        <span class="info-value">{{ "%.0f"|format(lot_area) }} sqm</span>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Zoning -->
        <div class="section">
            <div class="section-header">
                <h2>Zoning</h2>
            </div>
            <div class="section-content">
                <div class="card">
                    <div style="margin-bottom: 15px;">
                        <span class="zone-badge zone-{{ zone_category }}">{{ zone_code }}</span>
                        <span style="margin-left: 10px; font-size: 14pt; font-weight: 500;">{{ zone_name }}</span>
                    </div>

                    {% if zone_description %}
                    <p style="color: var(--gray-600); margin-bottom: 15px;">{{ zone_description }}</p>
                    {% endif %}

                    {% if permitted_uses %}
                    <div class="card-header">Permitted Uses (with consent)</div>
                    <ul class="list">
                        {% for use in permitted_uses[:8] %}
                        <li>
                            <span class="list-icon check-icon">✓</span>
                            {{ use }}
                        </li>
                        {% endfor %}
                        {% if permitted_uses|length > 8 %}
                        <li style="color: var(--gray-500);">+ {{ permitted_uses|length - 8 }} more...</li>
                        {% endif %}
                    </ul>
                    {% endif %}

                    {% if zone_objectives %}
                    <div class="card-header" style="margin-top: 15px;">Zone Objectives</div>
                    <ul class="list">
                        {% for obj in zone_objectives %}
                        <li>{{ obj }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Development Controls -->
        <div class="section">
            <div class="section-header">
                <h2>Development Controls</h2>
            </div>
            <div class="section-content">
                <table>
                    <thead>
                        <tr>
                            <th>Control</th>
                            <th>Value</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if height_limit %}
                        <tr>
                            <td>Maximum Building Height</td>
                            <td><strong>{{ "%.1f"|format(height_limit.max_value) }} {{ height_limit.unit }}</strong></td>
                            <td>{{ height_limit.notes or '' }}</td>
                        </tr>
                        {% endif %}
                        {% if fsr %}
                        <tr>
                            <td>Floor Space Ratio (FSR)</td>
                            <td><strong>{{ "%.2f"|format(fsr.max_value) }}:1</strong></td>
                            <td>{{ fsr.notes or '' }}</td>
                        </tr>
                        {% endif %}
                        {% for setback in setbacks %}
                        <tr>
                            <td>{{ setback.name }}</td>
                            <td><strong>{{ "%.1f"|format(setback.min_value) }} {{ setback.unit }}</strong></td>
                            <td>Minimum required</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>

                {% if estimated_gfa or estimated_storeys %}
                <div class="card" style="background: var(--gray-50);">
                    <div class="card-header">Estimated Building Envelope</div>
                    <div class="info-grid">
                        {% if estimated_gfa %}
                        <div class="info-item">
                            <span class="info-label">Estimated Max GFA</span>
                            <span class="info-value">{{ "%.0f"|format(estimated_gfa) }} sqm</span>
                        </div>
                        {% endif %}
                        {% if estimated_storeys %}
                        <div class="info-item">
                            <span class="info-label">Estimated Max Storeys</span>
                            <span class="info-value">{{ estimated_storeys }} storeys</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Hazards & Overlays -->
        {% if hazards or heritage or environmental %}
        <div class="section">
            <div class="section-header">
                <h2>Hazards & Constraints</h2>
            </div>
            <div class="section-content">
                {% if has_critical_hazards %}
                <div style="background: #fef2f2; border: 1px solid #fecaca; padding: 12px; border-radius: 6px; margin-bottom: 15px;">
                    <strong style="color: #991b1b;">⚠ Critical Hazard Warning</strong>
                    <p style="color: #7f1d1d; font-size: 10pt; margin-top: 4px;">
                        This property is affected by one or more high/extreme hazard overlays.
                        Development may be restricted or require specialist assessments.
                    </p>
                </div>
                {% endif %}

                {% for hazard in hazards %}
                <div class="hazard-alert {{ hazard.level.value if hazard.level else 'medium' }}">
                    <div class="hazard-icon">⚠</div>
                    <div class="hazard-content">
                        <h4>{{ hazard.name or hazard.hazard_type.value|title }}
                            <span class="badge badge-{{ 'danger' if hazard.level and hazard.level.value in ['high', 'extreme'] else 'warning' }}">
                                {{ hazard.level.value|upper if hazard.level else 'MEDIUM' }}
                            </span>
                        </h4>
                        {% if hazard.category %}
                        <p>Category: {{ hazard.category }}</p>
                        {% endif %}
                        {% if hazard.planning_implications %}
                        <ul style="margin-top: 8px; padding-left: 20px; font-size: 10pt;">
                            {% for imp in hazard.planning_implications %}
                            <li>{{ imp }}</li>
                            {% endfor %}
                        </ul>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}

                {% if heritage %}
                <div class="card">
                    <div class="card-header">Heritage Items</div>
                    {% for item in heritage %}
                    <div style="padding: 10px 0; border-bottom: 1px solid var(--gray-100);">
                        <strong>{{ item.listing_name }}</strong>
                        <span class="badge badge-info">{{ item.heritage_type.value|upper }}</span>
                        {% if item.listing_number %}
                        <span style="color: var(--gray-500); font-size: 10pt;">
                            ({{ item.listing_number }})
                        </span>
                        {% endif %}
                        {% if item.distance_m %}
                        <span style="color: var(--gray-500); font-size: 10pt;">
                            - {{ "%.0f"|format(item.distance_m) }}m away
                        </span>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Development Potential -->
        {% if scenarios %}
        <div class="section">
            <div class="section-header">
                <h2>Development Potential</h2>
            </div>
            <div class="section-content">
                {% for scenario in scenarios %}
                <div class="scenario-card">
                    <div class="scenario-header">
                        <span class="scenario-title">{{ scenario.scenario_name }}</span>
                        <span class="badge badge-{{ 'success' if scenario.feasibility_rating == 'high' else 'warning' if scenario.feasibility_rating == 'medium' else 'danger' }}">
                            {{ scenario.feasibility_rating|upper }} FEASIBILITY
                        </span>
                    </div>
                    <div class="info-grid" style="margin-bottom: 10px;">
                        {% if scenario.estimated_dwellings %}
                        <div class="info-item">
                            <span class="info-label">Est. Dwellings</span>
                            <span class="info-value">{{ scenario.estimated_dwellings }}</span>
                        </div>
                        {% endif %}
                        {% if scenario.estimated_gfa %}
                        <div class="info-item">
                            <span class="info-label">Est. GFA</span>
                            <span class="info-value">{{ "%.0f"|format(scenario.estimated_gfa) }} sqm</span>
                        </div>
                        {% endif %}
                    </div>
                    <div style="font-size: 10pt; color: var(--gray-600);">
                        <strong>Approval Pathway:</strong> {{ scenario.estimated_approval_pathway|upper }}
                    </div>
                    {% if scenario.key_requirements %}
                    <ul style="margin-top: 8px; padding-left: 20px; font-size: 10pt; color: var(--gray-600);">
                        {% for req in scenario.key_requirements %}
                        <li>{{ req }}</li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
                {% endfor %}

                {% if opportunities or constraints %}
                <div class="info-grid">
                    {% if opportunities %}
                    <div class="card" style="border-color: #86efac;">
                        <div class="card-header" style="color: var(--success);">Key Opportunities</div>
                        <ul class="list">
                            {% for opp in opportunities %}
                            <li>
                                <span class="list-icon check-icon">✓</span>
                                {{ opp }}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    {% if constraints %}
                    <div class="card" style="border-color: #fca5a5;">
                        <div class="card-header" style="color: var(--danger);">Key Constraints</div>
                        <ul class="list">
                            {% for con in constraints %}
                            <li>
                                <span class="list-icon warning-icon">!</span>
                                {{ con }}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Subdivision Potential -->
        {% if subdivision and subdivision.can_subdivide %}
        <div class="section">
            <div class="section-header">
                <h2>Subdivision Potential</h2>
            </div>
            <div class="section-content">
                <div class="card">
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Minimum Lot Size</span>
                            <span class="info-value">{{ "%.0f"|format(subdivision.min_lot_size) }} sqm</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Potential Lots</span>
                            <span class="info-value">{{ subdivision.potential_lots }}</span>
                        </div>
                    </div>
                    {% if subdivision.required_approvals %}
                    <div style="margin-top: 15px;">
                        <strong style="font-size: 10pt;">Required Approvals:</strong>
                        <ul style="padding-left: 20px; font-size: 10pt; color: var(--gray-600);">
                            {% for approval in subdivision.required_approvals %}
                            <li>{{ approval }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Footer -->
        <div class="footer">
            <div class="disclaimer">
                <strong>Disclaimer</strong>
                <p style="margin-top: 8px;">
                    This report is provided for informational purposes only and should not be relied upon as
                    legal or professional advice. All information should be independently verified with the
                    relevant local council and planning authorities before making any decisions.
                </p>
                <ul style="margin-top: 8px; padding-left: 20px;">
                    {% for limitation in limitations %}
                    <li>{{ limitation }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <strong>Data Sources:</strong>
                    {% for source in data_sources %}
                    {{ source }}{% if not loop.last %}, {% endif %}
                    {% endfor %}
                </div>
                <div>
                    <strong>Confidence Score:</strong> {{ confidence }}%
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center; color: var(--gray-400);">
                Generated by Siteora | siteora.com.au
            </div>
        </div>
    </div>
</body>
</html>
